const fs=require("fs"),path=require("path");var UglifyJS=require("uglify-js"),jsonminify=require("jsonminify"),minify=require("html-minifier").minify;console.log("Clearing old files...");try{fs.rmSync("./dist",{recursive:!0})}catch(i){}function copyFolderSync(e,o){fs.mkdirSync(o),fs.readdirSync(e).forEach(i=>{var n;fs.lstatSync(path.join(e,i)).isFile()?i.endsWith(".js")&&!i.endsWith(".min.js")?(console.log("Optimizing "+i),n=fs.readFileSync(path.join(e,i),"utf8"),n=UglifyJS.minify(n),fs.writeFileSync(path.join(o,i),n.code)):i.endsWith(".json")?(console.log("Optimizing "+i),n=fs.readFileSync(path.join(e,i),"utf8"),n=jsonminify(n),fs.writeFileSync(path.join(o,i),n)):i.endsWith(".html")?(console.log("Optimizing "+i),n=fs.readFileSync(path.join(e,i),"utf8"),n=minify(n,{minifyCSS:!0,minifyJS:!0}),fs.writeFileSync(path.join(o,i),n)):(console.log("Copying "+i),fs.copyFileSync(path.join(e,i),path.join(o,i))):"dist"!==i&&".git"!==i&&copyFolderSync(path.join(e,i),path.join(o,i))})}function cleanUps(){let i=fs.readFileSync("./dist/views/menu.html","utf8");i=i.replace('var actions="<%-JSON.stringify(actions)%>"',"var actions='<%-JSON.stringify(actions)%>'"),fs.writeFileSync("./dist/views/menu.html",i)}console.log("Optimizing..."),copyFolderSync("./","./dist"),console.log("Cleaning up..."),cleanUps(),console.log("Finished optimizing distribuition!");