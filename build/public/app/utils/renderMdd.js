const codeBlock=require("../components/codeBlock.js"),codeBlockHelper=require("./codeBlocks.js"),MultipleChoice=require("../components/EmbededMultipleChoice.js");var converter=new showdown.Converter({extentions:[]});module.exports=function(e){let a=0;return e=(e=(e=e.replace(/```[\S\s]*?```/g,function(e){let t=e.slice(3,e.indexOf("\n"));e=e.slice(e.indexOf("\n"),-3);return`<div class="codeblock-wrapper">
            ${new codeBlock({code:codeBlockHelper.escapeHtml(e),language:t.split("-")[0],name:t.split("-")[1]||""})}
        </div>`})).replace(/!!\(.*\)/g,function(e){return`<div class="image-wrapper info-text"><iframe src="${e.slice(3,-1)}" style="width: 100%; height: 400px; border-radius: 10px; display: block; margin-left: auto; margin-right: auto;" onload="resizeIframe(this)"></iframe></div>`})).replace(/<Q>.+?<\/Q>/gms,function(e){let t=e.slice(3,-4).split("\n").filter(e=>!!e),i="",s=[],c=[],r=0,l=0,o=0;t.forEach(e=>{let t=e.trim();t.startsWith("?")?i=t.slice(1):t.startsWith("!")?(t.endsWith("*")&&(r=s.length,t=t.slice(0,-1)),s.push(t.slice(1))):t.startsWith("+")?c.push(t.slice(1)):t.startsWith("p:")?l=Number(t.slice(2)):t.startsWith("c:")&&(o=Number(t.slice(2)))});var e="Multiple Choice Question",n=(s.find(e=>"true"===e.toLowerCase())&&s.find(e=>"false"===e.toLowerCase())&&(e="True or False"),new MultipleChoice({answers:s,correct:r,descriptions:c,points:l,coins:o,elementNum:a},null));return a++,`<div class="multiple-choice-wrapper" onclick="document.querySelector('.stack-width').classList.add('blur-all-non-mc-questions')">
            <div class="indicator-symbol">${e}</div>
            <canvas class="mc-answer-confetti"></canvas>
            <h3>${i}</h3>
            ${n}
        </div>`}),converter.makeHtml(e)};