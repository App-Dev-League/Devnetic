!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r((e="undefined"!=typeof globalThis?globalThis:e||self).loadPyodide={})}(this,function(e){"use strict";function E(e,a,s,l){return new(s=s||Promise)(function(t,r){function o(e){try{i(l.next(e))}catch(e){r(e)}}function n(e){try{i(l.throw(e))}catch(e){r(e)}}function i(e){var r;e.done?t(e.value):((r=e.value)instanceof s?r:new s(function(e){e(r)})).then(o,n)}i((l=l.apply(e,a||[])).next())})}var s,r,t,o,n={exports:{}},c=(n.exports=function(){function t(e){return e.charAt(0).toUpperCase()+e.substring(1)}function e(e){return function(){return this[e]}}var r=["isConstructor","isEval","isNative","isToplevel"],o=["columnNumber","lineNumber"],n=["fileName","functionName","source"],i=r.concat(o,n,["args"],["evalOrigin"]);function s(e){if(e)for(var r=0;r<i.length;r++)void 0!==e[i[r]]&&this["set"+t(i[r])](e[i[r]])}s.prototype={getArgs:function(){return this.args},setArgs:function(e){if("[object Array]"!==Object.prototype.toString.call(e))throw new TypeError("Args must be an Array");this.args=e},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(e){if(e instanceof s)this.evalOrigin=e;else{if(!(e instanceof Object))throw new TypeError("Eval Origin must be an Object or StackFrame");this.evalOrigin=new s(e)}},toString:function(){var e=this.getFileName()||"",r=this.getLineNumber()||"",t=this.getColumnNumber()||"",o=this.getFunctionName()||"";return this.getIsEval()?e?"[eval] ("+e+":"+r+":"+t+")":"[eval]:"+r+":"+t:o?o+" ("+e+":"+r+":"+t+")":e+":"+r+":"+t}},s.fromString=function(e){var r,t,o,n=e.indexOf("("),i=e.lastIndexOf(")"),a=e.substring(0,n),n=e.substring(n+1,i).split(","),e=e.substring(i+1);return 0===e.indexOf("@")&&(r=(i=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e,""))[1],t=i[2],o=i[3]),new s({functionName:a,args:n||void 0,fileName:r,lineNumber:t||void 0,columnNumber:o||void 0})};for(var a=0;a<r.length;a++)s.prototype["get"+t(r[a])]=e(r[a]),s.prototype["set"+t(r[a])]=function(r){return function(e){this[r]=Boolean(e)}}(r[a]);for(var l=0;l<o.length;l++)s.prototype["get"+t(o[l])]=e(o[l]),s.prototype["set"+t(o[l])]=function(t){return function(e){if(r=e,isNaN(parseFloat(r))||!isFinite(r))throw new TypeError(t+" must be a Number");var r;this[t]=Number(e)}}(o[l]);for(var c=0;c<n.length;c++)s.prototype["get"+t(n[c])]=e(n[c]),s.prototype["set"+t(n[c])]=function(r){return function(e){this[r]=String(e)}}(n[c]);return s}(),s=n.exports,r=/(^|@)\S+:\d+/,t=/^\s*at .*(\S+:\d+|\(native\))/m,{parse:function(e){if(void 0!==e.stacktrace||void 0!==e["opera#sourceloc"])return this.parseOpera(e);if(e.stack&&e.stack.match(t))return this.parseV8OrIE(e);if(e.stack)return this.parseFFOrSafari(e);throw new Error("Cannot parse given Error object")},extractLocation:function(e){if(-1===e.indexOf(":"))return[e];e=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/[()]/g,""));return[e[1],e[2]||void 0,e[3]||void 0]},parseV8OrIE:function(e){return e.stack.split("\n").filter(function(e){return!!e.match(t)},this).map(function(e){var r=(e=-1<e.indexOf("(eval ")?e.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""):e).replace(/^\s+/,"").replace(/\(eval code/g,"("),t=r.match(/ (\((.+):(\d+):(\d+)\)$)/),r=(r=t?r.replace(t[0],""):r).split(/\s+/).slice(1),t=this.extractLocation(t?t[1]:r.pop()),r=r.join(" ")||void 0,o=-1<["eval","<anonymous>"].indexOf(t[0])?void 0:t[0];return new s({functionName:r,fileName:o,lineNumber:t[1],columnNumber:t[2],source:e})},this)},parseFFOrSafari:function(e){return e.stack.split("\n").filter(function(e){return!e.match(o)},this).map(function(e){if(-1===(e=-1<e.indexOf(" > eval")?e.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1"):e).indexOf("@")&&-1===e.indexOf(":"))return new s({functionName:e});var r=/((.*".+"[^@]*)?[^@]*)(?:@)/,t=e.match(r),t=t&&t[1]?t[1]:void 0,r=this.extractLocation(e.replace(r,""));return new s({functionName:t,fileName:r[0],lineNumber:r[1],columnNumber:r[2],source:e})},this)},parseOpera:function(e){return!e.stacktrace||-1<e.message.indexOf("\n")&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(e){for(var r=/Line (\d+).*script (?:in )?(\S+)/i,t=e.message.split("\n"),o=[],n=2,i=t.length;n<i;n+=2){var a=r.exec(t[n]);a&&o.push(new s({fileName:a[2],lineNumber:a[1],source:t[n]}))}return o},parseOpera10:function(e){for(var r=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,t=e.stacktrace.split("\n"),o=[],n=0,i=t.length;n<i;n+=2){var a=r.exec(t[n]);a&&o.push(new s({functionName:a[3]||void 0,fileName:a[2],lineNumber:a[1],source:t[n]}))}return o},parseOpera11:function(e){return e.stack.split("\n").filter(function(e){return!!e.match(r)&&!e.match(/^Error created at/)},this).map(function(e){var r,t=e.split("@"),o=this.extractLocation(t.pop()),t=t.shift()||"",n=t.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0,t=void 0===(r=t.match(/\(([^)]*)\)/)?t.replace(/^[^(]+\(([^)]*)\)$/,"$1"):r)||"[arguments not available]"===r?void 0:r.split(",");return new s({functionName:n,args:t,fileName:o[0],lineNumber:o[1],columnNumber:o[2],source:e})},this)}});let S={noImageDecoding:!0,noAudioDecoding:!0,noWasmDecoding:!(o=/^(eval@)?(\[native code])?$/),preloadedWasm:{},preRun:[]},T={},O=(S.API=T,{}),i=(S.hiwire=O,{});T.tests=i;const u="undefined"!=typeof process&&process.release&&"node"===process.release.name&&void 0===process.browser;let d,p,f,y,h,_;if(h=u?function(r,t){return E(this,void 0,void 0,function*(){if(t.includes("://")){let e=yield p(t);if(e.ok||window.MacGap)return yield e.arrayBuffer();throw new Error(`Failed to load '${t}': request failed.`)}var e=yield y.readFile(""+r+t);return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)})}:function(n,i){return E(this,void 0,void 0,function*(){var e=new URL(n,location),e=new URL(i,e);let r=e.href,t=(console.log(r),yield fetch(r));if(!t.ok&&!window.MacGap){var o=r.indexOf("/brython")+"brython".length+1;if(r="https://cdn.jsdelivr.net/pyodide/v0.20.0/full"+(r=r.slice(o)),!(t=yield fetch(r)).ok)throw new Error(`Failed to load '${e}': request failed.`)}return new Uint8Array(yield t.arrayBuffer())})},globalThis.document)_=e=>E(void 0,void 0,void 0,function*(){return yield import(e)});else if(globalThis.importScripts)_=r=>E(void 0,void 0,void 0,function*(){try{globalThis.importScripts(r)}catch(e){if(!(e instanceof TypeError))throw e;yield import(r)}});else{if(!u)throw new Error("Cannot determine runtime environment");_=function(e){return E(this,void 0,void 0,function*(){e.includes("://")?f.runInThisContext(yield(yield p(e)).text()):yield import(d.resolve(e))})}}function N(e){return!!e&&void 0!==e.$$&&"PyProxy"===e.$$.type}T.isPyProxy=N,globalThis.FinalizationRegistry?S.finalizationRegistry=new FinalizationRegistry(([e,r])=>{r.leaked=!0,m(r);try{S._Py_DecRef(e)}catch(e){T.fatal_error(e)}}):S.finalizationRegistry={register(){},unregister(){}};let a,l,g=new Map;function $(e){var r=e.$$.ptr;if(0===r)throw new Error(e.$$.destroyed_msg);return r}S.pyproxy_alloc_map=g,S.enable_pyproxy_allocation_tracing=function(){a=function(e){g.set(e,Error().stack)},l=function(e){g.delete(e)}},S.disable_pyproxy_allocation_tracing=function(){a=function(e){},l=function(e){}},S.disable_pyproxy_allocation_tracing(),S.pyproxy_new=function(e,r){let t,o=S._pyproxy_getflags(e),n=S.getPyProxyClass(o);256&o?(delete(t=Reflect.construct(Function,[],n)).length,delete t.name,t.prototype=void 0):t=Object.create(n.prototype),(r=r||{cacheId:O.new_value(new Map),refcnt:0}).refcnt++,Object.defineProperty(t,"$$",{value:{ptr:e,type:"PyProxy",cache:r}}),S._Py_IncRef(e);var i=new Proxy(t,z);return a(i),S.finalizationRegistry.register(i,[e,r],i),i};let v=new Map;function m(r){if(r&&(r.refcnt--,0===r.refcnt)){let e=O.pop_value(r.cacheId);for(var t of e.values()){t=O.pop_value(t);r.leaked||S.pyproxy_destroy(t,"This borrowed attribute proxy was automatically destroyed in the process of destroying the proxy it was borrowed from. Try using the 'copy' method.")}}}S.getPyProxyClass=function(e){var r,t,o=[[1,L],[2,U],[4,D],[8,C],[16,M],[32,B],[64,W],[128,K],[256,b]],n=v.get(e);if(n)return n;let i={};for([r,t]of o)e&r&&Object.assign(i,Object.getOwnPropertyDescriptors(t.prototype));i.constructor=Object.getOwnPropertyDescriptor(w.prototype,"constructor"),Object.assign(i,Object.getOwnPropertyDescriptors({$$flags:e}));n=Object.create(w.prototype,i);function a(){}return a.prototype=n,v.set(e,a),a},S.PyProxy_getPtr=$,S.pyproxy_destroy=function(t,o){if(0!==t.$$.ptr){var n=$(t);S.finalizationRegistry.unregister(t),o=o||"Object has already been destroyed";let e,r=t.type;try{e=t.toString()}catch(e){if(e.pyodide_fatal_error)throw e}t.$$.ptr=0,o=(o+=`
The object was of type "${r}" and `)+(e?`had repr "${e}"`:"an error was raised when trying to generate its repr"),t.$$.destroyed_msg=o,m(t.$$.cache);try{S._Py_DecRef(n),l(t)}catch(e){T.fatal_error(e)}}},S.callPyObjectKwargs=function(e,...r){var t=r.pop(),o=r.length,n=Object.keys(t),t=Object.values(t),i=n.length;r.push(...t);let a,s=O.new_value(r),l=O.new_value(n);try{a=S.__pyproxy_apply(e,s,o,l,i)}catch(e){T.fatal_error(e)}finally{O.decref(s),O.decref(l)}0===a&&S._pythonexc2js();let c=O.pop_value(a);return c&&"coroutine"===c.type&&c._ensure_future&&c._ensure_future(),c},S.callPyObject=function(e,...r){return S.callPyObjectKwargs(e,...r,{})};class w{constructor(){throw new TypeError("PyProxy is not a constructor")}get[Symbol.toStringTag](){return"PyProxy"}get type(){var e=$(this);return O.pop_value(S.__pyproxy_type(e))}toString(){let e,r=$(this);try{e=S.__pyproxy_repr(r)}catch(e){T.fatal_error(e)}return 0===e&&S._pythonexc2js(),O.pop_value(e)}destroy(e){S.pyproxy_destroy(this,e)}copy(){var e=$(this);return S.pyproxy_new(e,this.$$.cache)}toJs({depth:e=-1,pyproxies:r,create_pyproxies:t=!0,dict_converter:o,default_converter:n}={}){let i,a,s=$(this),l=0,c=0;a=t?r?O.new_value(r):O.new_value([]):0,o&&(l=O.new_value(o)),n&&(c=O.new_value(n));try{i=S._python2js_custom(s,e,a,l,c)}catch(e){T.fatal_error(e)}finally{O.decref(a),O.decref(l),O.decref(c)}return 0===i&&S._pythonexc2js(),O.pop_value(i)}supportsLength(){return!!(1&this.$$flags)}supportsGet(){return!!(2&this.$$flags)}supportsSet(){return!!(4&this.$$flags)}supportsHas(){return!!(8&this.$$flags)}isIterable(){return!!(48&this.$$flags)}isIterator(){return!!(32&this.$$flags)}isAwaitable(){return!!(64&this.$$flags)}isBuffer(){return!!(128&this.$$flags)}isCallable(){return!!(256&this.$$flags)}}class L{get length(){let e,r=$(this);try{e=S._PyObject_Size(r)}catch(e){T.fatal_error(e)}return-1===e&&S._pythonexc2js(),e}}class U{get(e){let r,t=$(this),o=O.new_value(e);try{r=S.__pyproxy_getitem(t,o)}catch(e){T.fatal_error(e)}finally{O.decref(o)}if(0===r){if(!S._PyErr_Occurred())return;S._pythonexc2js()}return O.pop_value(r)}}class D{set(e,r){let t,o=$(this),n=O.new_value(e),i=O.new_value(r);try{t=S.__pyproxy_setitem(o,n,i)}catch(e){T.fatal_error(e)}finally{O.decref(n),O.decref(i)}-1===t&&S._pythonexc2js()}delete(e){let r,t=$(this),o=O.new_value(e);try{r=S.__pyproxy_delitem(t,o)}catch(e){T.fatal_error(e)}finally{O.decref(o)}-1===r&&S._pythonexc2js()}}class C{has(e){let r,t=$(this),o=O.new_value(e);try{r=S.__pyproxy_contains(t,o)}catch(e){T.fatal_error(e)}finally{O.decref(o)}return-1===r&&S._pythonexc2js(),1===r}}class M{[Symbol.iterator](){let e,r=$(this),t={};try{e=S._PyObject_GetIter(r)}catch(e){T.fatal_error(e)}0===e&&S._pythonexc2js();var o=function*(e,r){try{for(var t;t=S.__pyproxy_iter_next(e);)yield O.pop_value(t)}catch(e){T.fatal_error(e)}finally{S.finalizationRegistry.unregister(r),S._Py_DecRef(e)}S._PyErr_Occurred()&&S._pythonexc2js()}(e,t);return S.finalizationRegistry.register(o,[e,void 0],t),o}}class B{[Symbol.iterator](){return this}next(e){let r,t=O.new_value(e),o=S.stackSave(),n=S.stackAlloc(4);try{r=S.__pyproxyGen_Send($(this),t,n)}catch(e){T.fatal_error(e)}finally{O.decref(t)}e=S.HEAPU32[n>>2];return S.stackRestore(o),-1===r&&S._pythonexc2js(),{done:0===r,value:O.pop_value(e)}}}let z={isExtensible:()=>!0,has:(n,e)=>!!Reflect.has(n,e)||"symbol"!=typeof e&&function(e){let r,t=$(n),o=O.new_value(e);try{r=S.__pyproxy_hasattr(t,o)}catch(e){T.fatal_error(e)}finally{O.decref(o)}return-1===r&&S._pythonexc2js(),0!==r}(e=e.startsWith("$")?e.slice(1):e),get(e,r){if(r in e||"symbol"==typeof r)return Reflect.get(e,r);e=function(e,r){let t,o=$(e),n=O.new_value(r),i=e.$$.cache.cacheId;try{t=S.__pyproxy_getattr(o,n,i)}catch(e){T.fatal_error(e)}finally{O.decref(n)}return 0===t&&S._PyErr_Occurred()&&S._pythonexc2js(),t}(e,r=r.startsWith("$")?r.slice(1):r);return 0!==e?O.pop_value(e):void 0},set(n,i,a){var s=Object.getOwnPropertyDescriptor(n,i);if(s&&!s.writable)throw new TypeError(`Cannot set read only field '${i}'`);if("symbol"==typeof i)return Reflect.set(n,i,a);{s=i=i.startsWith("$")?i.slice(1):i,i=a;let e,r=$(n),t=O.new_value(s),o=O.new_value(i);try{e=S.__pyproxy_setattr(r,t,o)}catch(e){T.fatal_error(e)}finally{O.decref(t),O.decref(o)}-1===e&&S._pythonexc2js()}return!0},deleteProperty(o,n){var e=Object.getOwnPropertyDescriptor(o,n);if(e&&!e.writable)throw new TypeError(`Cannot delete read only field '${n}'`);if("symbol"==typeof n)return Reflect.deleteProperty(o,n);{n=n=n.startsWith("$")?n.slice(1):n;let e,r=$(o),t=O.new_value(n);try{e=S.__pyproxy_delattr(r,t)}catch(e){T.fatal_error(e)}finally{O.decref(t)}-1===e&&S._pythonexc2js()}return!e||!!e.configurable},ownKeys(e){let r,t=$(e);try{r=S.__pyproxy_ownKeys(t)}catch(e){T.fatal_error(e)}0===r&&S._pythonexc2js();let o=O.pop_value(r);return o.push(...Reflect.ownKeys(e)),o},apply:(e,r,t)=>e.apply(r,t)};class W{_ensure_future(){if(this.$$.promise)return this.$$.promise;let t,o,e,r=$(this),n=new Promise((e,r)=>{t=e,o=r}),i=O.new_value(t),a=O.new_value(o);try{e=S.__pyproxy_ensure_future(r,i,a)}catch(e){T.fatal_error(e)}finally{O.decref(a),O.decref(i)}return-1===e&&S._pythonexc2js(),this.$$.promise=n,this.destroy(),n}then(e,r){return this._ensure_future().then(e,r)}catch(e){return this._ensure_future().catch(e)}finally(e){return this._ensure_future().finally(e)}}class b{apply(e,r){return S.callPyObject($(this),...r)}call(e,...r){return S.callPyObject($(this),...r)}callKwargs(...e){if(0===e.length)throw new TypeError("callKwargs requires at least one argument (the key word argument object)");var r=e[e.length-1];if(void 0!==r.constructor&&"Object"!==r.constructor.name)throw new TypeError("kwargs argument is not an object");return S.callPyObjectKwargs($(this),...e)}}b.prototype.prototype=Function.prototype;let P,J=new Map([["i8",Int8Array],["u8",Uint8Array],["u8clamped",Uint8ClampedArray],["i16",Int16Array],["u16",Uint16Array],["i32",Int32Array],["u32",Uint32Array],["i32",Int32Array],["u32",Uint32Array],["i64",globalThis.BigInt64Array],["u64",globalThis.BigUint64Array],["f32",Float32Array],["f64",Float64Array],["dataview",DataView]]);class K{getBuffer(e){let r;if(e&&void 0===(r=J.get(e)))throw new Error("Unknown type "+e);let t,o=S.HEAPU32,n=S.stackSave(),i=S.stackAlloc(o[S._buffer_struct_size>>2]),a=$(this);try{t=S.__pyproxy_get_buffer(i,a)}catch(e){T.fatal_error(e)}-1===t&&S._pythonexc2js();let s=o[i>>2],l=o[1+(i>>2)],c=o[2+(i>>2)],u=!!o[3+(i>>2)],d=o[4+(i>>2)],p=o[5+(i>>2)],f=O.pop_value(o[6+(i>>2)]),y=O.pop_value(o[7+(i>>2)]),h=o[8+(i>>2)],_=!!o[9+(i>>2)],g=!!o[10+(i>>2)],v=S.UTF8ToString(d),m=(S.stackRestore(n),!1);try{let e=!1;void 0===r&&([r,e]=S.processBufferFormatString(v," In this case, you can pass an explicit type argument."));var w=parseInt(r.name.replace(/[^0-9]/g,""))/8||1;if(e&&1<w)throw new Error("Javascript has no native support for big endian buffers. In this case, you can pass an explicit type argument. For instance, `getBuffer('dataview')` will return a `DataView`which has native support for reading big endian data. Alternatively, toJs will automatically convert the buffer to little endian.");var b=c-l;if(0!=b&&(s%w!=0||l%w!=0||c%w!=0))throw new Error("Buffer does not have valid alignment for a "+r.name);var P,x=b/w,j=(s-l)/w,k=0==b?new r:new r(o.buffer,l,x);for(P of y.keys())y[P]/=w;return m=!0,Object.create(G.prototype,Object.getOwnPropertyDescriptors({offset:j,readonly:u,format:v,itemsize:p,ndim:f.length,nbytes:b,shape:f,strides:y,data:k,c_contiguous:_,f_contiguous:g,_view_ptr:h,_released:!1}))}finally{if(!m)try{S._PyBuffer_Release(h),S._PyMem_Free(h)}catch(e){T.fatal_error(e)}}}}class G{constructor(){throw new TypeError("PyBuffer is not a constructor")}release(){if(!this._released){try{S._PyBuffer_Release(this._view_ptr),S._PyMem_Free(this._view_ptr)}catch(e){T.fatal_error(e)}this._released=!0,this.data=null}}}const H=/^.*?([^\/]*)\.whl$/;function V(r,t){return E(this,void 0,void 0,function*(){let e;if("default channel"===t){if(!(r in T.packages))throw new Error("Internal error: no entry for package named "+r);e=T.packages[r].file_name}else e=t;return yield h(P,e)})}function q(o,n){return E(this,void 0,void 0,function*(){var e,r=(e=T.packages[o]||{file_name:".whl",install_dir:"site",shared_library:!1,depends:[],imports:[]}).file_name;for(const t of T.package_loader.unpack_buffer.callKwargs({buffer:n,filename:r,target:e.install_dir,calculate_dynlibs:!0}))yield Y(t,e.shared_library);A[o]=e})}function Q(){let t=Promise.resolve();return function(){return E(this,void 0,void 0,function*(){var e=t;let r;return t=new Promise(e=>r=e),yield e,r})}}const X=Q();function Y(o,n){return E(this,void 0,void 0,function*(){var e=S.FS.lookupPath(o).node.mount.type==S.FS.filesystems.MEMFS?S.FS.filesystems.MEMFS.getFileDataAsTypedArray(S.FS.lookupPath(o).node):S.FS.readFile(o);const r=yield X();try{var t=yield S.loadWebAssemblyModule(e,{loadAsync:!0,nodelete:!0,allowUndefined:!0});S.preloadedWasm[o]=t,S.preloadedWasm[o.split("/").pop()]=t,n&&S.loadDynamicLibrary(o,{global:!0,nodelete:!0})}catch(e){if(e.message.includes("need to see wasm magic number"))return void console.warn(`Failed to load dynlib ${o}. We probably just tried to load a linux .so file or something.`);throw e}finally{r()}})}i.loadDynlib=Y;const Z=Q();function x(k,O,$){return E(this,void 0,void 0,function*(){O=O||console.log,$=$||console.error,N(k)&&(k=k.toJs());const[e,r]=function(e,r){const t=new Map,o=new Map;for(var n of e){var i=function(e){let r=H.exec(e);if(r)return r[1].toLowerCase().split("-").slice(0,-4).join("-")}(n);void 0!==i?t.has(i)&&t.get(i)!==n?r(`Loading same package ${i} from ${n} and `+t.get(i)):t.set(i,n):function e(r,t,o){if(r=r.toLowerCase(),!t.has(r)){var n=T.packages[r];if(!n)throw new Error(`No known package with name '${r}'`);if((n.shared_library?o:t).set(r,"default channel"),void 0===A[r])for(var i of n.depends)e(i,t,o)}}(n,t,o)}return[t,o]}(k=Array.isArray(k)?k:[k],$);for(var[t,o]of[...e,...r]){var n=A[t];void 0!==n&&(e.delete(t),r.delete(t),n===o||"default channel"===o?O(t+" already loaded from "+n):$(`URI mismatch, attempting to load package ${t} from ${o} while it is already loaded from ${n}. To override a dependency, load the custom package first.`))}if(0===e.size&&0===r.size)O("No new packages to load");else{const f=[...e.keys(),...r.keys()].join(", "),y=yield Z();try{O("Loading "+f);const h={},_={};for(var[i,a]of r)A[i]?r.delete(i):h[i]=V(i,a);for(var[s,l]of e)A[s]?e.delete(s):_[s]=V(s,l);const g=[],v={},m={},w={};for(const[b,P]of r)m[b]=h[b].then(e=>E(this,void 0,void 0,function*(){yield q(b,e),g.push(b),A[b]=P})).catch(e=>{console.warn(e),v[b]=e});yield Promise.all(Object.values(m));for(const[x,j]of e)w[x]=_[x].then(e=>E(this,void 0,void 0,function*(){yield q(x,e),g.push(x),A[x]=j})).catch(e=>{console.warn(e),v[x]=e});var c;if(yield Promise.all(Object.values(w)),S.reportUndefinedSymbols(),0<g.length&&(c=g.join(", "),O("Loaded "+c)),0<Object.keys(v).length){var u,d,p=Object.keys(v).join(", ");O("Failed to load "+p);for([u,d]of Object.entries(v))console.warn(`The following error occurred while loading ${u}:`),console.error(d)}T.importlib.invalidate_caches()}finally{y()}}})}let A={};function ee(r){if("string"==typeof r)r=new Error(r);else if("object"!=typeof r||null===r||"string"!=typeof r.stack||"string"!=typeof r.message){let e=`A value of type ${typeof r} with tag ${Object.prototype.toString.call(r)} was thrown as an error!`;try{e+=`
String interpolation of the thrown value gives """${r}""".`}catch(r){e+="\nString interpolation of the thrown value fails."}try{e+=`
The thrown value's toString method returns """${r.toString()}""".`}catch(r){e+="\nThe thrown value's toString method fails."}r=new Error(e)}return r}let re=!(T.dump_traceback=function(){S.__Py_DumpTraceback(1,S._PyGILState_GetThisThreadState())});T.fatal_error=function(e){if(!e||!e.pyodide_fatal_error){if(re)return console.error("Recursive call to fatal_error. Inner error was:"),void console.error(e);(e=("number"==typeof e?oe:ee)(e)).pyodide_fatal_error=!0,re=!0,console.error("Pyodide has suffered a fatal error. Please report this to the Pyodide maintainers."),console.error("The cause of the fatal error was:"),T.inTestHoist?(console.error(e.toString()),console.error(e.stack)):console.error(e);try{T.dump_traceback();for(var r of Object.keys(T.public_api))r.startsWith("_")||"version"===r||Object.defineProperty(T.public_api,r,{enumerable:!0,configurable:!0,get:()=>{throw new Error("Pyodide already fatally failed and can no longer be used.")}});T.on_fatal&&T.on_fatal(e)}catch(e){console.error("Another error occurred while handling the fatal error:"),console.error(e)}throw e}};class te extends Error{constructor(e,r){super(r),this.ty=e}}function oe(e){n=e,r=S._exc_type(),i=new S.ExceptionInfo(n).get_type(),o=S.stackSave(),t=S.stackAlloc(4),S.HEAP32[t/4]=n,n=S.demangle(S.UTF8ToString(S._exc_typename(i))),r=!!S.___cxa_can_catch(r,i,t),i=S.HEAP32[t/4],S.stackRestore(o);var r,[t,o,n]=[n,r,i],i=o?(r=S._exc_what(n),S.UTF8ToString(r)):`The exception is an object of type ${t} at address ${e} which does not inherit from std::exception`;return new te(t,i)}function j(r){const e=r.fileName||"";if(e.includes("pyodide.asm"))return 1;if(e.includes("wasm-function"))return 1;if(e.includes("pyodide.js")){let e=r.functionName||"";return!((e=e.startsWith("Object.")?e.slice("Object.".length):e)in T.public_api)||"PythonError"===e||(r.functionName=e,0)}}Object.defineProperty(te.prototype,"name",{get(){return this.constructor.name+" "+this.ty}}),i.convertCppException=oe,S.handle_js_error=function(o){if(o&&o.pyodide_fatal_error)throw o;if(!(o instanceof S._PropagatePythonError)){let e,r,t=!1;o instanceof T.PythonError&&(t=S._restore_sys_last_exception(o.__error_address));try{e=c.parse(o)}catch(e){r=!0}if(r&&(o=ee(o)),t||(o=O.new_value(o),a=S._JsProxy_create(o),S._set_error(a),S._Py_DecRef(a),O.decref(o)),!r){if(j(a=e[0])&&("PythonError"===(o=a.functionName)||"new_error"===o))for(;j(e[0]);)e.shift();for(const s of e){if(j(s))break;var n=S.stringToNewUTF8(s.functionName||"???"),i=S.stringToNewUTF8(s.fileName||"???.js");S.__PyTraceback_Add(n,i,s.lineNumber),S._free(n),S._free(i)}}}var a};class k extends Error{constructor(e,r){var t=Error.stackTraceLimit;Error.stackTraceLimit=1/0,super(e),Error.stackTraceLimit=t,this.__error_address=r}}Object.defineProperty(k.prototype,"name",{value:k.name}),T.PythonError=k;class F extends Error{constructor(){T.fail_test=!0,super("If you are seeing this message, an internal Pyodide error has occurred. Please report it to the Pyodide maintainers.")}}Object.defineProperty(F.prototype,"name",{value:F.name}),S._PropagatePythonError=F;let R=!1;function ne(e,r={}){return T.isPyProxy(r)&&(r={globals:r},R||(console.warn("Passing a PyProxy as the second argument to runPython is deprecated and will be removed in v0.21. Use 'runPython(code, {globals : some_dict})' instead."),R=!0)),r.globals||(r.globals=T.globals),T.pyodide_py.eval_code(e,r.globals)}function ie(r,n,i){return E(this,void 0,void 0,function*(){let t,e=T.pyodide_py.find_imports(r);try{t=e.toJs()}finally{e.destroy()}if(0!==t.length){let e=T._import_name_to_package_name,r=new Set;for(var o of t)e.has(o)&&r.add(e.get(o));r.size&&(yield x(Array.from(r),n,i))}})}function ae(e,r={}){return E(this,void 0,void 0,function*(){return T.isPyProxy(r)&&(r={globals:r},R||(console.warn("Passing a PyProxy as the second argument to runPythonAsync is deprecated and will be removed in v0.21. Use 'runPythonAsync(code, {globals : some_dict})' instead."),R=!0)),r.globals||(r.globals=T.globals),yield T.pyodide_py.eval_code_async(e,r.globals)})}function se(e,r){T.pyodide_py.register_js_module(e,r)}function le(e){T._Comlink=e}function ce(e){T.pyodide_py.unregister_js_module(e)}function ue(e,{depth:r,defaultConverter:t}={depth:-1}){switch(typeof e){case"string":case"number":case"boolean":case"bigint":case"undefined":return e}if(!e||T.isPyProxy(e))return e;let o=0,n=0,i=0;try{o=O.new_value(e);try{n=S.js2python_convert(o,{depth:r,defaultConverter:t})}catch(e){throw e instanceof S._PropagatePythonError&&S._pythonexc2js(),e}if(S._JsProxy_Check(n))return e;0===(i=S._python2js(n))&&S._pythonexc2js()}finally{O.decref(o),S._Py_DecRef(n)}return O.pop_value(i)}function de(e){return T.importlib.import_module(e)}T.runPython=ne,T.runPythonAsync=ae;let pe,fe,ye=!1;function he(e,r,t={}){"string"==typeof t&&(ye||(console.warn("Passing a string as the third argument to unpackArchive is deprecated and will be removed in v0.21. Instead use { extract_dir : 'some_path' }"),ye=!0),t={extractDir:t});t=t.extractDir;T.package_loader.unpack_buffer.callKwargs({buffer:e,format:r,extract_dir:t})}function _e(e){S.HEAP8[S._Py_EMSCRIPTEN_SIGNAL_HANDLING]=!!e,S.Py_EmscriptenSignalBuffer=e}function ge(){S.__PyErr_CheckSignals()&&S._pythonexc2js()}function I(l={}){return E(this,void 0,void 0,function*(){if(I.inProgress)throw new Error("Pyodide is already loading.");l.indexURL||(l.indexURL=function(){let r;try{throw new Error}catch(e){r=e}const e=c.parse(r)[0].fileName;return e.slice(0,e.lastIndexOf("/"))}());var e={fullStdLib:I.inProgress=!0,jsglobals:globalThis,stdin:globalThis.prompt||void 0,homedir:"/home/pyodide"};let r=Object.assign(e,l);r.indexURL.endsWith("/")||(r.indexURL+="/"),yield function(){return E(this,void 0,void 0,function*(){u&&(d=(yield import("path")).default,y=yield import("fs/promises"),p=(yield import("node-fetch")).default,f=(yield import("vm")).default)})}();var t,o,e=function(n){return E(this,void 0,void 0,function*(){let r;if(P=n,u){var e=yield y.readFile(n+"packages.json");r=JSON.parse(e)}else{let e=yield fetch(n+"packages.json");r=yield e.json()}if(!r.packages)throw new Error("Loaded packages.json does not contain the expected key 'packages'.");T.packages=r.packages,T._import_name_to_package_name=new Map;for(var t of Object.keys(T.packages))for(var o of T.packages[t].imports)T._import_name_to_package_name.set(o,t)})}(r.indexURL),n=h(r.indexURL,"pyodide_py.tar"),i=(o=r.stdin,i=r.stdout,a=r.stderr,i&&(S.print=i),a&&(S.printErr=a),o&&S.preRun.push(function(){S.FS.init(function(r){const t=new TextEncoder;let o=new Uint8Array(0),n=-1;return function(){try{if(-1===n){let e=r();if(null==e)return null;if("string"!=typeof e)throw new TypeError(`Expected stdin to return string, null, or undefined, got type ${typeof e}.`);e.endsWith("\n")||(e+="\n"),o=t.encode(e),n=0}var e;return n<o.length?(e=o[n],n++,e):(n=-1,null)}catch(e){throw console.error("Error thrown in stdin:"),console.error(e),e}}}(o),null,null)}),t=r.homedir,S.preRun.push(function(){try{S.FS.mkdirTree(t)}catch(e){console.error(`Error occurred while making a home directory '${t}':`),console.error(e),console.error("Using '/' for a home directory instead"),t="/"}S.ENV.HOME=t,S.FS.chdir(t)}),new Promise(e=>S.postRun=e)),a=(S.locateFile=e=>r.indexURL+e,r.indexURL+"pyodide.asm.js"),a=(yield _(a),yield _createPyodideModule(S),yield i,S.locateFile=e=>{throw new Error("Didn't expect to load any more file_packager files!")},yield n),i=S.FS.open("/pyodide_py.tar","w"),n=(S.FS.write(i,a,0,a.byteLength,void 0,!0),S.FS.close(i),S.stringToNewUTF8('\nfrom sys import version_info\npyversion = f"python{version_info.major}.{version_info.minor}"\nimport shutil\nshutil.unpack_archive("/pyodide_py.tar", f"/lib/{pyversion}/site-packages/")\ndel shutil\nimport importlib\nimportlib.invalidate_caches()\ndel importlib\n    '));if(S._PyRun_SimpleString(n))throw new Error("OOPS!");S._free(n),S.FS.unlink("/pyodide_py.tar"),S._pyodide_init();let s=function(e){fe=T._pyodide._base.eval_code("{}"),T.importlib=T.runPythonInternal("import importlib; importlib");let r=T.importlib.import_module;T.sys=r("sys"),T.sys.path.insert(0,e.homedir);var o,t=T.runPythonInternal("import __main__; __main__.__dict__"),n=T.runPythonInternal("import builtins; builtins.__dict__");T.globals=(o=n,new Proxy(t,{get:(t,e)=>"get"===e?e=>{let r=t.get(e);return r=void 0===r?o.get(e):r}:"has"===e?e=>t.has(e)||o.has(e):Reflect.get(t,e)}));let i=T._pyodide._importhook,a=(i.register_js_finder(),i.register_js_module("js",e.jsglobals),n={globals:void 0,FS:pe=S.FS,pyodide_py:void 0,version:"",loadPackage:x,loadPackagesFromImports:ie,loadedPackages:A,isPyProxy:N,runPython:ne,runPythonAsync:ae,registerJsModule:se,unregisterJsModule:ce,setInterruptBuffer:_e,checkInterrupt:ge,toPy:ue,pyimport:de,unpackArchive:he,registerComlink:le,PythonError:k,PyBuffer:G,_module:S,_api:T},T.public_api=n);return i.register_js_module("pyodide_js",a),T.pyodide_py=r("pyodide"),T.package_loader=r("pyodide._package_loader"),T.version=T.pyodide_py.__version__,a.pyodide_py=T.pyodide_py,a.version=T.version,a.globals=T.globals,a}(r);return yield e,r.fullStdLib&&(yield x(["distutils"])),s.runPython("print('Python initialization complete')"),s})}T.saveState=()=>T.pyodide_py._state.save_state(),T.restoreState=e=>T.pyodide_py._state.restore_state(e),T.runPythonInternal=function(e){return T._pyodide._base.eval_code(e,fe)},globalThis.loadPyodide=I,e.loadPyodide=I,Object.defineProperty(e,"__esModule",{value:!0})});