<html>

<body>
    <div id="python-sandbox-bridge"></div>
</body>

</html>
<py-env class="pyscript-dependencies">
    ...
</py-env>
<py-script class="pyscript-script-out loading" output="output">
    ...
</py-script>
<div id="output"></div>

<script>function registerWatchers(){var t=document.querySelector("#output");new MutationObserver(function(e){t.classList.contains("loading")||e.forEach(function(e){e.addedNodes.length&&(e.addedNodes[0].nodeValue?window.logFunction(e.addedNodes[0].nodeValue):document.getElementById("output").lastChild.querySelector("img")&&window.showImage(document.getElementById("output").lastChild.innerHTML))})}).observe(t,{childList:!0,subtree:!0,characterData:!0})}window.addEventListener("message",e=>{"start"===e.data&&(document.querySelector(".pyscript-script-out").innerHTML=window.pythonCode,document.querySelector(".pyscript-dependencies").innerHTML=Object.keys(window.pythonDependencies).map(e=>"- "+e).join("\n"),document.querySelector(".pyscript-script-out").classList.remove("loading"),(e=document.createElement("script")).type="text/javascript",e.src="./pyscript.js",document.head.appendChild(e),registerWatchers())}),console.oldLog=console.log,console.log=function(e){e.toString().includes("ModuleNotFoundError")||e.toString().includes("Exception")||e.toString().includes("PythonError")?window.logFunction(e.toString()):console.oldLog("Pyscript log > "+e.toString())},console.warn=function(e){e.toString().startsWith("Python")&&window.logFunction(e.toString())}</script>