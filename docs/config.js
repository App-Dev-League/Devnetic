function recurseEjs(n,o={}){return new Promise(async(e,t)=>{o.include=async function(e){let t=await tApp.get(e);return recurseEjs(await t.text(),o)},e(await ejs.render(n,o,{async:!0}))})}function confirmRedoLesson(){return new Promise((e,t)=>{let n=document.getElementById("snippets-modal"),o=n.cloneNode(!0),i=(o.removeAttribute("id"),o.classList.remove("none"),o.querySelector("h3").innerHTML="You have already completed this module!",o.querySelector("h3").style.fontSize="1.5em",o.querySelector(".button-correct").innerHTML="Redo Module",o.querySelector(".button-correct").cloneNode());i.innerHTML="Next Module",i.style.marginLeft="10px",i.style.backgroundColor="var(--blue-selected)",o.querySelector(".button-correct").parentNode.appendChild(i),o.querySelector("span").onclick=function(){e("stay"),o.parentNode.removeChild(o)},o.querySelector(".button-correct").onclick=async function(){o.parentElement.removeChild(o),e(!0)},i.onclick=function(){o.parentElement.removeChild(o),e(!1)},document.body.appendChild(o)})}(async()=>{await installAll(["CodeEditor.js","CodePreview.js","Congratulations.js","Editor.js","ExplanationModal.js","Information.js","Input.js","Instructions.js","ModuleComponent.js","ModulePage.js","MultipleChoice.js","MultipleChoiceOption.js","ShortAnswer.js","SnippetsPanel.js","SnippetUnlock.js","TabbedView.js","codeBlock.js","PluginPanel.js","PreviewStandalone.js"],{path:"./components/"},newFileCallback),await installAll(["codeBlocks.js","codeEditor.js","codeTemplateToCode.js","compileSnippet.js","doesFileExist.js","Database.js","plugins.js","shuffleArray.js","renderElement.js"],{path:"./utils/"},newFileCallback),await install("./assets/libraries/ejs.js");const e=require("./components/ModulePage.js"),m=require("./components/Information.js"),u=require("./components/MultipleChoice.js"),h=require("./components/ShortAnswer.js"),f=require("./components/SnippetUnlock.js"),w=require("./components/Congratulations.js"),l=require("./components/CodeEditor.js"),r=require("./components/PreviewStandalone.js"),y=require("./utils/codeTemplateToCode.js"),j=require("./utils/shuffleArray.js"),b=require("./utils/Database.js");require("./utils/plugins.js"),require("./assets/libraries/ejs.js");var t={target:document.querySelector("tapp-main"),ignoreRoutes:[],forbiddenRoutes:[],errorPages:{notFound:"#/404",forbidden:"#/403"},caching:{backgroundPages:["/tApp.js","/require-browser.js","/","/config.js","/index.html","/manifest.json",...["ai","index","intro-to-cs","menu","my-projects","webdev-projects","webdev"].map(e=>`/views/${e}.html`),...["codeBlocks","codeEditor","codeTemplateToCode","compileSnippet","Database","doesFileExist","plugins","shuffleArray","renderElement.js"].map(e=>`/utils/${e}.js`),"/assets/fonts/codicon.ttf",...["Black.ttf","BlackItalic.ttf","Bold.woff2","BoldItalic.ttf","ExtraBold.woff2","ExtraBoldItalic.ttf","ExtraLight.ttf","ExtraLightItalic.ttf","Italic.ttf","Light.ttf","LightItalic.ttf","Regular.woff2","SemiBold.woff2","SemiBoldItalic.ttf"].map(e=>"/assets/fonts/Nunito/Nunito-"+e),"/assets/fonts/Nunito/OFL.txt",...["codeBlock","CodeEditor","CodePreview","Congratulations","Editor","ExplanationModal","Information","Input","Instructions","ModuleComponent","ModulePage","MultipleChoice","MultipleChoiceOption","PluginPanel","ShortAnswer","SnippetUnlock","SnippetsPanel","TabbedView"].map(e=>`/components/${e}.js`),"/assets/html/code-editor.html","/assets/html/preview-editor.html","/assets/libraries/highlightjs/atom-one-dark.css","/assets/libraries/highlightjs/highlight.min.js","/assets/libraries/monaco-editor/vs/loader.js","/assets/libraries/bootstrap/bootstrap.bundle.min.js","/assets/libraries/bootstrap/bootstrap.min.css",...["ejs","jquery.min"].map(e=>`/assets/libraries/${e}.js`),"/assets/stylesheets/lighttheme.css",...["icon","screenshot"].map(e=>`/assets/img/${e}.png`),...["0","1","2","3","4","5","6","7"].map(e=>`/data/modules/ai/${e}.json`),...["0","1","2","3","4","5","6","7"].map(e=>`/data/modules/webdev/${e}.json`),...["0","1","2","3","4","5","6","7"].map(e=>`/data/modules/webdev-projects/${e}.json`),...["0","1"].map(e=>`/data/modules/intro-to-cs/${e}.json`),...["img0/0-0.png","img0/1-0.png","img0/2-0.png","img0/2-1.png","img0/2-2.png","img0/2-3.png","img0/4-0.png","img0/4-1.png","img0/4-2.png","img0/4-3.png","img0/8-0.png","img0/8-1.png","img0/8-2.png","img0/8-3.png","img1/0-0.png","img1/3-0.png","img1/5-0.png","img1/5-1.png","img1/5-2.png","img1/6-0.png","img1/7-0.png","img1/8-0.png","img4/1-0.png","bootstrap-example.html","/img5/0-0.png","/img5/1-0.png","/img5/1-1.png","/img5/2-0.png","/img5/2-1.png","/img5/4-0.png","/img5/4-1.png","/img5/5-0.png","/img5/5-1.png","/img5/5-2.png","/img5/6-0.png","/img5/6-1.png","/img5/7-0.png","/img5/7-1.gif","/img6/0-0.png","/img6/0-1.png","/img6/0-2.png","/img6/1-0.png","/img6/2-0.png","/img6/2-1.png","/img6/3-0.png","/img6/3-1.png","/img6/3-2.png","/img6/4-0.png","/img6/5-0.png","/img7/0-0.png","/img7/1-0.png","/img7/2-0.png","/img7/3-0.png","/img7/4-0.png","/img7/5-0.png"].map(e=>"/data/modules/webdev-assets/"+e),...["img0/0-0.png","img0/1-0.png","img1/0-1.png","img1/1-1.png","img2/0-2.png","img2/1-2.png","img2/2-2.png","img2/3-2.png","img2/4-2.png","img2/5-2.png","img3/0-3.png","img4/0-0.png","img4/0-1.png","img4/1-0.png","img4/1-1.png","img4/2-0.png","img4/2-1.png","img4/2-2.png","img4/3-0.png","img4/3-1.png","img4/3-2.png","img5/0-0.png","img5/0-1.png","img5/0-2.png","img5/0-3.png","img5/0-4.png","img5/1-0.png","img5/1-1.png","img5/1-2.png","img5/1-3.png","img5/1-4.png","img5/1-5.png","img5/2-0.gif","img5/2-1.png","img5/2-2.png","img5/2-3.png","img5/3-0.png","img5/3-1.png","img5/3-2.png","img5/3-3.png","img5/3-4.png","img5/3-5.png","img6/0-0.png","img6/1-0.png","img6/2-0.png","img6/3-0.png","img6/4-0.png","img6/4-1.png","img6/5-0.png","img6/5-1.png","img6/6-0.png","img7/0-0.png","img7/0-1.png","img7/0-2.png","img7/0-3.png","img7/1-0.png","img7/1-1.png","img7/1-2.png","img7/1-3.png","img7/1-4.png","img7/1-5.png","img7/2-0.png","img7/3-0.png","img7/3-1.png","img7/3-2.png","img7/3-3.png","img7/4-0.png","img7/4-1.png","img7/4-2.png","img7/4-3.png","img7/4-4.png","img7/4-5.png","img7/4-6.png","img7/4-7.png"].map(e=>"/data/modules/ai-assets/"+e),...["img0/0-0.png"].map(e=>"/data/modules/intro-to-cs-assets/"+e)],periodicUpdate:36e5,persistent:!0}};"development"==window.environment&&(t.caching=null),tApp.configure(t),tApp.route("/",function(e){tApp.redirect("#/")}),tApp.route("#/",function(e){tApp.get("./views/index.html").then(e=>e.text()).then(async e=>{e=await recurseEjs(e);tApp.render(e)})}),tApp.route("#/track/<track>",function(e){tApp.get(`./views/${e.data.track}.html`).then(e=>e.text()).then(async e=>{e=await recurseEjs(e);tApp.render(e)}).catch(e=>{tApp.renderPath("#/404")})}),tApp.route("#/my-projects",function(e){tApp.get("./views/my-projects.html").then(e=>e.text()).then(async e=>{e=await recurseEjs(e,{myProjectsPage:!0});tApp.render(e)})}),tApp.route("#/learn/<track>/<module>/",async function(e){tApp.redirect(`#/learn/${e.data.track}/${e.data.module}/${await b.getModulePosition(e.data.track,e.data.module)}/`)}),window.DB=b;let A=new e({Database:b});tApp.route("#/preview/<track>/<module>/<position>/<fileIndex>",async function(i){async function t(e,t=!1){let{data:n,moduleData:o}=e;window.tAppRequestInstance=i,window.currentModuleData=o,n.isUserProject=t,n.previewIndex=i.data.fileIndex,A.setComponent(new r({},A),n)}i.data.module=parseInt(i.data.module),i.data.position=parseInt(i.data.position),i.data.fileIndex=parseInt(i.data.fileIndex),A.state.track=i.data.track,A.state.module=i.data.module,A.state.position=i.data.position,"customUserProjects"===i.data.track?t({type:"project",moduleLength:1,next:{hasNext:!0,module:i.data.module,position:1},data:{type:"code_editor",storage_id:[],files:[],default:[],display_type:"web",elements:[],hints:[],validation:[],points:0,coins:0}},!0):b.getModuleData(i.data.track,i.data.module,i.data.position).then(async e=>{t(e)}).catch(e=>{tApp.renderPath("#/404")}),tApp.render(A.toString())}),tApp.route("#/learn/<track>/<module>/<position>",function(p){async function t(e,t=!1){let{data:r,type:n,moduleLength:o,next:i,moduleData:s}=e,a=(document.getElementById("module-progress-bar").style.width=p.data.position/o*100+"%",window.tAppRequestInstance=p,window.currentModuleData=s,0);if(document.querySelectorAll(".module-progress-bar-timeline-element").forEach(e=>{e.classList.contains("template")||e.parentElement.removeChild(e)}),t||window.currentModuleData.pages.forEach(e=>{let t=document.getElementById("module-progress-bar-wrapper"),n=t.querySelector(".template"),o=n.cloneNode(!0);o.classList.remove("template"),o.style.left=a/window.currentModuleData.pages.length*100+"%",p.data.position>a?o.classList.add("filled"):o.classList.remove("filled"),"information"===e.type&&(o.querySelector(".name").innerText=e.title||"",o.querySelector(".descriptor").innerHTML="<b>Type: </b>Learn"),"multiple_choice"===e.type&&(o.querySelector(".name").innerText=e.question.slice(0,10)+"..."||"",o.querySelector(".descriptor").innerHTML="<b>Type: </b>Question"),"snippet_unlock"===e.type&&(o.querySelector(".name").innerText=e.name.slice(0,10)+"..."||"",o.querySelector(".descriptor").innerHTML="<b>Type: </b>Snippet"),"short_answer"===e.type&&(o.querySelector(".name").innerText=e.question.slice(0,10)+"..."||"",o.querySelector(".descriptor").innerHTML="<b>Type: </b>Question"),"congratulations"===e.type&&(o.querySelector(".name").innerText="Lesson summary",o.querySelector(".descriptor").innerHTML="<b>Type: </b>Summary"),"code_editor"===e.type&&(o.querySelector(".name").innerText=e.elements[0].content.replaceAll("[[h3]]","").replaceAll("[[/]]",""),o.querySelector(".descriptor").innerHTML="<b>Type: </b>Project"),a++,t.appendChild(o)}),p.data.position>=o)return!0===(e=await confirmRedoLesson())?tApp.redirect(`#/learn/${p.data.track}/${p.data.module}/0`):"stay"===e?tApp.redirect("#/track/"+p.data.track):void(i.hasNext?tApp.redirect(`#/learn/${p.data.track}/${i.module}/`+i.position):tApp.redirect("#/"));if("lesson"==n||"project"==n){if(null!=r.code_template&&(r.code=y(r.code_template)),i.hasNext?A.state.next=`#/learn/${p.data.track}/${i.module}/`+i.position:A.state.next="#/",A.state.track=p.data.track,A.state.module=p.data.module,A.state.position=p.data.position,"information"==r.type)A.setComponent(new m({},A),r);else if("multiple_choice"==r.type){let n=j([...r.answers]),o=[];for(let t=0;t<n.length;t++)o.push(r.answers.findIndex(e=>e===n[t]));let t=[];for(let e=0;e<o.length;e++)t.push(r.answers[o[e]]);let i=[];for(let e=0;e<o.length;e++)i.push(r.descriptions[o[e]]);if(r.answers=t,r.descriptions=i,Array.isArray(r.correct)){let e=[...r.correct];r.correct=[],e.forEach(t=>r.correct.push(o.findIndex(e=>e===t)))}else r.correct=o.findIndex(e=>e===r.correct);A.setComponent(new u({},A),r)}else"short_answer"==r.type?A.setComponent(new h({},A),r):"snippet_unlock"==r.type?A.setComponent(new f({},A),r):"congratulations"==r.type?A.setComponent(new w({},A),r):"code_editor"==r.type&&(r.isUserProject=t,A.setComponent(new l({},A),r));tApp.render(A.toString())}else tApp.renderPath("#/404"),console.error("Unknown type "+n)}p.data.module=parseInt(p.data.module),p.data.position=parseInt(p.data.position),"customUserProjects"===p.data.track?t({type:"project",moduleLength:1,next:{hasNext:!0,module:p.data.module,position:1},data:{type:"code_editor",storage_id:[],files:[],default:[],display_type:"web",elements:[],hints:[],validation:[],points:0,coins:0}},!0):b.getModuleData(p.data.track,p.data.module,p.data.position).then(async e=>{t(e)}).catch(e=>{tApp.renderPath("#/404")})}),tApp.route("#/DEV-SHOW-ALL",async function(s){var a="",n={},t={"Webdev Lessons":"webdev","Webdev Projects":"webdev-projects","AI Lessons":"ai"},o={};for(let e=0;e<Object.entries(t).length;e++){Object.entries(t)[e][0];var i=Object.entries(t)[e][1],r=(n[i]=[],0),p=0,l=await DB.getModuleCount(i),g=[];for(let t=0;t<l;t++){let e=await DB.getModuleData(i,t,0);var c=await DB.getModulePosition(i,t);n[i].push(c),e.currentUserPosition=c,g.push(e),r+=e.moduleLength}n[i]?(n[i].forEach(e=>{null!==e&&(p+=e)}),o[i]={totalPages:r,userPages:p,data:g}):o[i]={totalPages:r,userPages:0,data:g}}var d=[];Object.entries(o).forEach(([i,e])=>{e.data.forEach((e,o)=>{for(let t=0;t<e.moduleLength-1;t++)d.push(new Promise((n,e)=>{b.getModuleData(i,o,t).then(t=>{try{let{data:r,type:e}=t;if(window.tAppRequestInstance=s,"lesson"==e||"project"==e){if(null!=r.code_template&&(r.code=y(r.code_template)),"information"==r.type)A.setComponent(new m({},A),r);else if("multiple_choice"==r.type){let n=j([...r.answers]),o=[];for(let t=0;t<n.length;t++)o.push(r.answers.findIndex(e=>e===n[t]));let t=[];for(let e=0;e<o.length;e++)t.push(r.answers[o[e]]);let i=[];for(let e=0;e<o.length;e++)i.push(r.descriptions[o[e]]);if(r.answers=t,r.descriptions=i,Array.isArray(r.correct)){let e=[...r.correct];r.correct=[],e.forEach(t=>r.correct.push(o.findIndex(e=>e===t)))}else r.correct=o.findIndex(e=>e===r.correct);A.setComponent(new u({},A),r)}else"short_answer"==r.type?A.setComponent(new h({},A),r):"snippet_unlock"==r.type?A.setComponent(new f({},A),r):"congratulations"==r.type&&A.setComponent(new w({},A),r);A&&(a+=A.toString()),n()}}catch(e){n()}})}))})}),await Promise.all(d),await new Promise((e,t)=>{setTimeout(()=>{e()},500)}),console.log("Done"),tApp.render(a)}),tApp.route("#/404",function(e){tApp.render(`
			<h1>Error 404</h1>
			<p>Page not found.</p>
		`)}),tApp.route("#/403",function(e){tApp.render(`
			<h1>Error 403</h1>
			<p>Access denied.</p>
		`)});t=await b.getScore();document.querySelector("#score").innerHTML=`${t.points} XP, ${t.coins} Coins`,tApp.start().then(()=>{"development"!==window.environment&&tApp.install().then(()=>{tApp.update()})})})();let redirectFunction=tApp.redirect;tApp.redirect=function(e,t){redirectFunction(e,t),onWindowHashChange()};